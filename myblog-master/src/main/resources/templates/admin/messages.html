<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="admin/_fragments :: head(~{::title})">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>留言管理</title>
    <link rel="stylesheet" href="../static/css/me.css" th:href="@{/css/me.css}">
    <link rel="stylesheet" href="../static/css/animate.css" th:href="@{/css/animate.css}">
</head>

<style>
    .width-60 {
        width: 40%;
    }

    .content img {
        width: 40px;
        height: 40px;
    }

</style>

<body>

<nav th:replace="admin/_fragments :: menu(0)"
     class="navbar navbar-inverse lucency-only-box-all rounded-no animated fadeIn">
    <div class="container">

        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">切换</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#" th:href="@{/}"><b>Blog</b></a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1" style="overflow: visible !important;">
            <ul class="nav navbar-nav">

                <li class="active"><a><span class="glyphicon glyphicon-home"></span> 首页</a></li>
                <li><a href="#">
                    <sapn class="glyphicon glyphicon-tag"></sapn>
                    分类</a></li>
                <li><a href="#">
                    <sapn class="glyphicon glyphicon-align-left"></sapn>
                    标签</a></li>
                <li><a href="#"><span class="glyphicon glyphicon-list"></span> 归档</a></li>
                <li><a href="#"><span class="glyphicon glyphicon-list"></span> 关于我</a></li>
                <li><a href="#"><span class="glyphicon glyphicon-comment"></span> 留言板</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <form class="navbar-form navbar-left" role="search">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search">
                        </div>
                        <button type="submit" class="btn btn-default">Submit</button>
                    </form>
                </li>
            </ul>
        </div>
    </div>
</nav>
<br><br><br><br><br><br>


<div class="container">

    <div class="row about-margin-top-adjustment" id="messagesnew" th:fragment="messagesfragments">

        <div class="col-md-12">
            <div class="panel lucency-only-box-sm"  id="top">

                <!--panel-heading-->
                <div class="panel-heading" id="messageb">
                    <h1 class="text-center font-HUAWENXINWEI">管理留言</h1>
                </div>
                <!--panel-body-->
                <div class="panel-body">

                    <!--留言-->
                    <div>
                        <!--评论标题-->
                        <h3>留言</h3>
                        <hr>
                        <div id="commentContainer">

                            <hr>
                            <div th:fragment="messageboard">
                                <!--评论内容-->
                                <ul class="media-list">
                                    <div th:each="message : ${messagesboard}">
                                        <div class="media">
                                            <!--头像区域-->
                                            <div class="media-left">
                                                <a href="#">
                                                    <img th:if="${message.admin == false}"
                                                         class="img-size-40 img-circle"
                                                         src="../static/images/avatar/boy.png"
                                                         th:src="${message.avatar}">
                                                    <img th:if="${message.admin == true}" class="img-size-40 img-circle"
                                                         src="../static/images/avatar/avatar2.jpg"
                                                         th:src="${user.avatar}">
                                                </a>
                                            </div>
                                            <!--评论区域-->
                                            <div class="media-body">
                                                <span>id: </span><span th:text="${message.id}"></span>
                                                <!--昵称-->
                                                <h5 class="media-heading"><b th:text="${message.nickname}">任一</b>
                                                    <label th:if="${message.admin == true}"
                                                           class="label label-info">管理员</label>
                                                </h5>
                                                <p class="content">
                                                    <!--评论信息-->
                                                    <span th:utext="${message.content}">
                                                        评论信息...
                                                </span>
                                                    <span th:utext="${message.email}">
                                                                email
                                                </span>
                                                </p>
                                                <!--创评论建时间-->
                                                <span class="text-color-teal" th:text="${message.createtime}"></span>
                                                <!--回复按钮-->
                                                <a class="btn btn-danger btn-sm" href="javascript:void(0);"
                                                   onclick="replyComment(this)"
                                                   th:attr="data-currentid=${message.id},data-nickname=${message.nickname}">删除</a>
                                                <!--子评论-->
                                                <ul class="media" th:if="${message.getSonMessage().size() > 0}"
                                                    th:each="son : ${message.getSonMessage()}">
                                                    <!--子评论头像区域-->
                                                    <div class="media-left">
                                                        <a href="#">
                                                            <img th:if="${son.admin == false}"
                                                                 class="img-size-40 img-circle"
                                                                 src="../static/images/avatar/boy.png"
                                                                 th:src="${son.avatar}">
                                                            <img th:if="${son.admin == true}"
                                                                 class="img-size-40 img-circle"
                                                                 src="../static/images/avatar/avatar2.jpg"
                                                                 th:src="${user.avatar}">
                                                        </a>
                                                    </div>
                                                    <!--子评论内容区域-->
                                                    <div class="media-body">
                                                        <span>id: </span><span th:text="${son.id}"></span>
                                                        <h5 class="media-heading"><b th:text="${son.nickname}">任一</b>
                                                            <label th:if="${son.admin == true}"
                                                                   class="label label-info">管理员</label>
                                                            <span class="text-color-teal"
                                                                  th:text="|@${son.parentMessage.nickname}|"></span>
                                                        </h5>
                                                        <p>
                                                            <span th:utext="${son.content}">
                                                                评论信息...
                                                            </span>
                                                            <span th:utext="${son.email}">
                                                                email
                                                            </span>
                                                        </p>
                                                        <span class="text-color-teal"
                                                              th:text="${son.createtime}"></span>
                                                        <a class="btn btn-danger btn-sm" href="javascript:void(0);"
                                                           onclick="replyComment(this)"
                                                           th:attr="data-currentid=${son.id},data-nickname=${son.nickname}">删除</a>
                                                    </div>
                                                </ul>
                                            </div>
                                        </div>
                                        <hr class="hr-width-90">
                                    </div>
                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>
</div>

<!--<div class="container-fluid margin-left margin-right" th:fragment="messagesfragments">-->
<!--<div class="row" id="messages">-->
<!--<div class="col-md-12">-->
<!--<div class="panel shadow-gray-xs lucency-only-box-sm" style="padding: 10px;">-->
<!--<table class="table table-hover table-responsive table-border-radius">-->
<!--<thead>-->
<!--<tr class="circle_tr">-->
<!--<th>序号</th>-->
<!--<th>id</th>-->
<!--<th>内容</th>-->
<!--&lt;!&ndash;<th>头像</th>&ndash;&gt;-->
<!--<th>日期</th>-->
<!--<th>邮箱</th>-->
<!--<th>昵称</th>-->
<!--<th>父级</th>-->
<!--<th>管理员</th>-->
<!--<th>操作</th>-->
<!--</tr>-->
<!--</thead>-->
<!--<tbody>-->
<!--<tr th:each="message,iterStat : ${messages}">-->
<!--<td th:text="${iterStat.count}"></td>-->
<!--<td th:text="${message.id}"></td>-->
<!--<td class="width-60" th:text="${message.content}"></td>-->
<!--<td th:text="${message.createtime}"></td>-->
<!--<td th:text="${message.email}"></td>-->
<!--<td th:text="${message.nickname}"></td>-->
<!--<td th:text="${message.parentid}"></td>-->
<!--<td th:text="${message.admin}"></td>-->
<!--<td>-->
<!--<button th:attr="data-messageid=${message.id}" class="btn btn-danger" onclick="deleteMessage(this)">删除</button>-->
<!--</td>-->
<!--</tr>-->
<!--</tbody>-->
<!--</table>-->
<!--</div>-->
<!--</div>-->
<!--</div>-->
<!--</div>-->

<!--工具条-->
<div id="toolbar" class="m-padded m-fixed m-right-bottom" style="display: none">
    <div class="btn-group-vertical" role="group" aria-label="...">
        <a href="javascript:void(0);" onclick="gotoTop();" class="btn btn-info">
            <span class="glyphicon glyphicon-upload"></span>
        </a>
    </div>
</div>
<br>
<br>
<br>
<br>
<br>
</body>

<th:block th:replace="admin/_fragments :: script">
    <script src="../static/js/jq.js" th:src="@{/js/jq.js}"></script>
    <script src="../static/lib/prism/prism.js" th:src="@{/lib/prism/prism.js}"></script>
    <script src="../static/lib/tocbot/tocbot.min.js" th:src="@{/lib/tocbot/tocbot.min.js}"></script>
    <script src="../static/lib/qrcode/qrcode.min.js" th:src="@{/lib/qrcode/qrcode.min.js}"></script>
    <script src="../static/lib/waypoints/jquery.waypoints.min.js"
            th:src="@{/lib/waypoints/jquery.waypoints.min.js}"></script>
    <script src="../static/lib/editormd/editormd.min.js" th:src="@{/lib/editormd/editormd.min.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
</th:block>

<script>
    function deleteMessage(data) {
        var really = confirm("彻底删除这个评论吗?");
        if (really) {
            $("#messages").load('/admin/messages/delete', {id: $(data).data("messageid")})
        }
    }
</script>

<script>
    function replyComment(obj) {
        var really = confirm("彻底删除这个评论吗?");
        if (really) {
            $("#messagesnew").load('/admin/messages/delete', {id: $(obj).data("currentid")})
        }
    }
</script>

</html>